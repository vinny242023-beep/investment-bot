import logging
import sqlite3
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, CallbackContext

BOT_TOKEN = "8203632125:AAFl3OqXf4mKeijmA1-YFmJGP9UMUbCxl0I"
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –§–ò–ù–ê–ù–°–û–í–´–• –ó–ù–ê–ù–ò–ô ---

BOOKS_MENU = [
    "–°–∞–º—ã–π –±–æ–≥–∞—Ç—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ –í–∞–≤–∏–ª–æ–Ω–µ",
    "–†–∞–∑—É–º–Ω—ã–π –∏–Ω–≤–µ—Å—Ç–æ—Ä",
    "–î—É–º–∞–π –∏ –±–æ–≥–∞—Ç–µ–π"
]

BOOKS_CONTENT = {
    "–°–∞–º—ã–π –±–æ–≥–∞—Ç—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ –í–∞–≤–∏–ª–æ–Ω–µ":
    """
    –ì–ª–∞–≤–∞ 1. –î–µ–Ω—å–≥–∏ –ª—é–±—è—Ç —Å—á—ë—Ç.
    ¬´–ù–∞—á–Ω–∏ –∫–æ–ø–∏—Ç—å —Ö–æ—Ç—è –±—ã 10% –¥–æ—Ö–æ–¥–∞. –ù–µ –≤–∞–∂–Ω–æ —Å–∫–æ–ª—å–∫–æ —Ç—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å ‚Äî –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –≤—Å–µ–≥–¥–∞.¬ª

    –ì–ª–∞–≤–∞ 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏.
    ¬´–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–π –∂–µ–ª–∞–Ω–∏—è. –ù–µ —Ç—Ä–∞—Ç—å –Ω–∞ —Ç–æ, –±–µ–∑ —á–µ–≥–æ –º–æ–∂–Ω–æ –ø—Ä–æ–∂–∏—Ç—å.¬ª

    –ì–ª–∞–≤–∞ 3. –ó–∞—Å—Ç–∞–≤—å –¥–µ–Ω—å–≥–∏ —Ä–∞–±–æ—Ç–∞—Ç—å.
    ¬´–ü—É—Å—Ç—å –∫–∞–∂–¥–∞—è –º–æ–Ω–µ—Ç–∞ —Ç—Ä—É–¥–∏—Ç—Å—è –∏ –ø—Ä–∏–Ω–æ—Å–∏—Ç –Ω–æ–≤—ã–µ –¥–µ–Ω—å–≥–∏!¬ª

    –ì–ª–∞–≤–∞ 4. –ë–µ—Ä–µ–≥–∏ –∫–∞–ø–∏—Ç–∞–ª –æ—Ç —É–±—ã—Ç–∫–æ–≤.
    ¬´–ù–µ —Ä–∏—Å–∫—É–π —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è–º–∏, –≤—ã–±–∏—Ä–∞–π –Ω–∞–¥—ë–∂–Ω—ã–µ –≤–ª–æ–∂–µ–Ω–∏—è.¬ª

    –ì–ª–∞–≤–∞ 5. –ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π —Ä–∞–∑—É–º–Ω–æ.
    ¬´–£–º–µ–π –æ—Ç–ª–∏—á–∏—Ç—å —Ö–æ—Ä–æ—à–∏–µ –≤–ª–æ–∂–µ–Ω–∏—è –æ—Ç –ø–ª–æ—Ö–∏—Ö. –°–≤–æ–π –æ–ø—ã—Ç ‚Äî —Ç–≤–æ—è –≥–ª–∞–≤–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å.¬ª

    –ì–ª–∞–≤–∞ 6. –ó–∞—â–∏—Ç–∞ –¥–µ–Ω–µ–≥ –∏ –∑–Ω–∞–Ω–∏–π.
    ¬´–ü—Ä–∏—Å–ª—É—à–∏–≤–∞–π—Å—è –∫ —Å–æ–≤–µ—Ç—É —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤. –£—á–∏—Å—å —É –º–∞—Å—Ç–µ—Ä–æ–≤.¬ª

    –ì–ª–∞–≤–∞ 7. –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è.
    ¬´–î–ª—è –±–æ–≥–∞—Ç—Å—Ç–≤–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–µ—Ä–ø–µ–Ω–∏–µ, –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å. –ù–µ —Å–¥–∞–≤–∞–π—Å—è!¬ª
    """,

    "–†–∞–∑—É–º–Ω—ã–π –∏–Ω–≤–µ—Å—Ç–æ—Ä":
    """
    –ì–ª–∞–≤–∞ 1. –û—Å–Ω–æ–≤—ã –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
    ¬´–í—Å–µ–≥–¥–∞ –ø–ª–∞–Ω–∏—Ä—É–π, –Ω–∞ –∫–∞–∫–æ–π —Å—Ä–æ–∫ –∏ —Å –∫–∞–∫–∏–º —Ä–∏—Å–∫–æ–º —Ç—ã –≤–∫–ª–∞–¥—ã–≤–∞–µ—à—å –¥–µ–Ω—å–≥–∏.¬ª

    –ì–ª–∞–≤–∞ 2. –ü—Å–∏—Ö–æ–ª–æ–≥–∏—è vs. –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞
    ¬´–ì–ª–∞–≤–Ω—ã–π –≤—Ä–∞–≥ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ ‚Äî –Ω–µ —Ä—ã–Ω–æ–∫, –∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç–º–æ—Ü–∏–∏: —Å—Ç—Ä–∞—Ö –∏ –∂–∞–¥–Ω–æ—Å—Ç—å.¬ª

    –ì–ª–∞–≤–∞ 3. –ú–∞—Ä–∂–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
    ¬´–ü–æ–∫—É–ø–∞–π –∞–∫—Ç–∏–≤ —Å –∑–∞–ø–∞—Å–æ–º ‚Äî –ø–æ —Ü–µ–Ω–µ –Ω–∏–∂–µ –µ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏.¬ª

    –ì–ª–∞–≤–∞ 4. –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
    ¬´–õ—É—á—à–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π 8% –≥–æ–¥–æ–≤—ã—Ö —Å –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π, —á–µ–º –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ —Å–ø–µ–∫—É–ª—è—Ü–∏–∏.¬ª

    –ì–ª–∞–≤–∞ 5. –ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—Ñ–ª—è—Ü–∏–∏.
    ¬´–î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä—É–π –∞–∫—Ç–∏–≤—ã ‚Äî –∞–∫—Ü–∏–∏, –æ–±–ª–∏–≥–∞—Ü–∏–∏, –≤–∞–ª—é—Ç–∞, –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å.¬ª

    –ì–ª–∞–≤–∞ 6. –û—à–∏–±–∫–∏ –∏ —É—Ä–æ–∫–∏.
    ¬´–£—Å–ø–µ—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫ —Ç–µ–º, –∫—Ç–æ —Ç–µ—Ä–ø–µ–ª–∏–≤ –∏ —É–º–µ–µ—Ç —É—á–∏—Ç—å—Å—è –Ω–∞ –æ—à–∏–±–∫–∞—Ö –¥—Ä—É–≥–∏—Ö.¬ª
    """,

    "–î—É–º–∞–π –∏ –±–æ–≥–∞—Ç–µ–π":
    """
    –ì–ª–∞–≤–∞ 1. –ú–µ—á—Ç–∞–π –∏ –¥–µ–π—Å—Ç–≤—É–π!
    ¬´–°–∏–ª—å–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ –±–æ–≥–∞—Ç—Å—Ç–≤–∞ ‚Äî –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ —Ä–µ–∞–ª—å–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º.¬ª

    –ì–ª–∞–≤–∞ 2. –í–µ—Ä—å, —á—Ç–æ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ.
    ¬´–ù–∞—Å—Ç–æ–π—á–∏–≤–æ –ø–æ–≤—Ç–æ—Ä—è–π —Å–≤–æ–∏ —Ü–µ–ª–∏, –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π —É—Å–ø–µ—Ö.¬ª

    –ì–ª–∞–≤–∞ 3. –ü–ª–∞–Ω–∏—Ä—É–π –∏ –Ω–µ –±–æ–π—Å—è –æ—à–∏–±–∞—Ç—å—Å—è.
    ¬´–ë–µ–∑ —á—ë—Ç–∫–æ–≥–æ –ø–ª–∞–Ω–∞ –Ω–µ –±—ã–≤–∞–µ—Ç –ø—É—Ç–∏ –∫ –±–æ–≥–∞—Ç—Å—Ç–≤—É.¬ª

    –ì–ª–∞–≤–∞ 4. –£—á–∏—Å—å –Ω–∞ –∫–∞–∂–¥–æ–º –ø–æ—Ä–∞–∂–µ–Ω–∏–∏.
    ¬´–ö–∞–∂–¥–∞—è –Ω–µ—É–¥–∞—á–∞ ‚Äî —ç—Ç–æ –æ–ø—ã—Ç –∏ —à–∞–≥ –∫ –±—É–¥—É—â–µ–π –ø–æ–±–µ–¥–µ.¬ª

    –ì–ª–∞–≤–∞ 5. –ú–∞—Å—Ç–µ—Ä–º–∞–π–Ω–¥.
    ¬´–û–∫—Ä—É–∂–∏ —Å–µ–±—è —Ç–∞–∫–∏–º–∏ –∂–µ —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª—ë–Ω–Ω—ã–º–∏ –ª—é–¥—å–º–∏.¬ª

    –ì–ª–∞–≤–∞ 6. –≠–Ω—Ç—É–∑–∏–∞–∑–º –∏ –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ.
    ¬´–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ —ç–Ω–µ—Ä–≥–∏—è ‚Äî –≥–ª–∞–≤–Ω–æ–µ —Ç–æ–ø–ª–∏–≤–æ –±–æ–≥–∞—Ç–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞.¬ª
    """
}

INVEST_TIPS = [
    "–í–∫–ª–∞–¥—ã–≤–∞–π —Ç–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã–µ –¥–µ–Ω—å–≥–∏.",
    "–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π –ø–æ–¥—É—à–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (3-6 –º–µ—Å—è—Ü–µ–≤ —Ä–∞—Å—Ö–æ–¥–æ–≤).",
    "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π –ø—Ä–æ—Ü–µ—Å—Å: –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–π –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü.",
    "–ü–æ–∫—É–ø–∞–π ETF –Ω–∞ –∏–Ω–¥–µ–∫—Å ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–∞.",
    "–ù–µ –ø—ã—Ç–∞–π—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ä–æ—Å—Ç –∏–ª–∏ –ø–∞–¥–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞.",
    "–î–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä—É–π ‚Äî –Ω–µ –¥–µ—Ä–∂–∏ –≤—Å—ë –≤ –æ–¥–Ω–æ–º –∞–∫—Ç–∏–≤–µ.",
    "–§–∏–∫—Å–∏—Ä—É–π –æ—à–∏–±–∫–∏ –≤ –¥–Ω–µ–≤–Ω–∏–∫–µ –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞–π –ø–ª–∞–Ω.",
    "–ù–µ –ø–∞–Ω–∏–∫—É–π –Ω–∞ –ø—Ä–æ—Å–∞–¥–∫–∞—Ö ‚Äî —Ä—ã–Ω–æ–∫ —Ä–∞—Å—Ç—ë—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ.",
    "–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π –∫–æ–º–∏—Å—Å–∏–∏ –∏ –ª–∏—à–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.",
    "–°–º–æ—Ç—Ä–∏ –Ω–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞ –Ω–µ –±—ã—Å—Ç—Ä—É—é –ø—Ä–∏–±—ã–ª—å."
]

MONEY_MANAGEMENT_TIPS = [
    "–°–¥–µ–ª–∞–π –ø—Ä–∏–≤—ã—á–∫–æ–π –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å 10% –¥–æ—Ö–æ–¥–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è.",
    "–†–∞–∑–¥–µ–ª–∏ –¥–µ–Ω—å–≥–∏: —Ä–∞—Å—Ö–æ–¥—ã, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è, –æ–±—É—á–µ–Ω–∏–µ, –ø–æ–º–æ—â—å –¥—Ä—É–≥–∏–º.",
    "–°–æ—Å—Ç–∞–≤—å –¥–æ–º–∞—à–Ω–∏–π –±—é–¥–∂–µ—Ç –∏ —Ñ–∏–∫—Å–∏—Ä—É–π –≤—Å–µ —Ç—Ä–∞—Ç—ã —Ö–æ—Ç—è –±—ã –º–µ—Å—è—Ü.",
    "–ü–æ–∫—É–ø–∞–π –Ω–æ–≤—ã–µ –≤–µ—â–∏ —Ç–æ–ª—å–∫–æ –ø–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.",
    "–û—Ü–µ–Ω–∏ –∫–∞–∂–¥—É—é –∫—Ä—É–ø–Ω—É—é –ø–æ–∫—É–ø–∫—É —á–µ—Ä–µ–∑ ¬´–ü—Ä–∞–≤–∏–ª–æ 24 —á–∞—Å–æ–≤¬ª: –ø–µ—Ä–µ–Ω–æ—á—É–π —Å –º—ã—Å–ª—å—é.",
    "–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π –∫—Ä–µ–¥–∏—Ç—ã –∏ –¥–æ–ª–≥–∏ ‚Äî –≤—ã–ø–ª–∞—á–∏–≤–∞–π —Å–Ω–∞—á–∞–ª–∞ —Å –∫—Ä—É–ø–Ω—ã–º–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏.",
    "–†–∞–∑ –≤ –ø–æ–ª–≥–æ–¥–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ü–µ–ª–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –±—é–¥–∂–µ—Ç.",
    "–£—á–∏—Å—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏ ‚Äî —á–∏—Ç–∞–π, —Å–ª—É—à–∞–π –ø–æ–¥–∫–∞—Å—Ç—ã, –ø—Ä–æ—Ö–æ–¥–∏ –∫—É—Ä—Å—ã."
]

MOTIVATION = [
    "–ö–∞–∂–¥—ã–π –±–æ–≥–∞—Ç—ã–π —á–µ–ª–æ–≤–µ–∫ –∫–æ–≥–¥–∞-—Ç–æ –±—ã–ª –±–µ–¥–Ω—ã–º. –í—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–±—è!",
    "–ï—Å–ª–∏ —Ç—ã –Ω–∞—á–∞–ª ‚Äî —Ç—ã —É–∂–µ –ª—É—á—à–µ, —á–µ–º 90% –æ—Å—Ç–∞–ª—å–Ω—ã—Ö, –∫—Ç–æ —Ç–æ–ª—å–∫–æ –¥—É–º–∞–µ—Ç.",
    "–°–∏–ª–∞ ‚Äî –≤ —Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –≤ —Ä–∞–∑–º–µ—Ä–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞.",
    "–ë–æ–ª—å—à–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—ã—Å—è—á–∏ –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞–≥–æ–≤.",
    "–ù–µ –±–æ–π—Å—è –æ—à–∏–±–∞—Ç—å—Å—è ‚Äî –±–æ–π—Å—è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å.",
    "–í—Ä–µ–º—è ‚Äî —Ç–≤–æ–π –≥–ª–∞–≤–Ω—ã–π —Å–æ—é–∑–Ω–∏–∫: –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–π —Å–µ–≥–æ–¥–Ω—è, —á—Ç–æ–±—ã –ø–æ–∂–∞—Ç—å –ø–ª–æ–¥—ã –∑–∞–≤—Ç—Ä–∞.",
    "–¢—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—à—å –Ω–µ —Ä—ã–Ω–æ–∫, –Ω–æ —Å–≤–æ–π –≤–∫–ª–∞–¥ –∏ —Å–≤–æ—é –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É.",
    "–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–≤–æ–±–æ–¥–∞ ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ –¥–µ–Ω—å–≥–∏, –Ω–æ –ø—Ä–æ –≤—ã–±–æ—Ä –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å."
]

FAQ = [
    "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–µ—Ç –±–æ–ª—å—à–∏—Ö –¥–æ—Ö–æ–¥–æ–≤? ‚Äî –ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ! –î–∞–∂–µ 500‚ÇΩ –≤ –º–µ—Å—è—Ü ‚Äî –ø—É—Ç—å –∫ –∫–∞–ø–∏—Ç–∞–ª—É.",
    "–ù—É–∂–Ω–æ –ª–∏ –±—ã—Ç—å —Ñ–∏–Ω–∞–Ω—Å–∏—Å—Ç–æ–º? ‚Äî –ù–µ—Ç. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–∞—É—á–∏—Ç—å—Å—è –±–∞–∑–æ–≤—ã–º –ø—Ä–∞–≤–∏–ª–∞–º, –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ.",
    "–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Ä—ã–Ω–∫–∞? ‚Äî –ù–µ –ø–∞–Ω–∏–∫–æ–≤–∞—Ç—å, –Ω–µ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –≤ —É–±—ã—Ç–æ–∫. –õ—É—á—à–µ –¥–æ–∫—É–ø–∞–π –∞–∫—Ç–∏–≤—ã.",
    "–ö–∞–∫–æ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –¥–æ–≤–µ—Ä—è—Ç—å? ‚Äî –ö–ª–∞—Å—Å–∏–∫–∞: –ö–ª–µ–π—Å–æ–Ω, –ì—Ä—ç–º, –•–∏–ª–ª. –ò–∑—É—á–∞–π –æ–ø—ã—Ç –ø—Ä–∞–∫—Ç–∏–∫–æ–≤.",
    "–í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∏–Ω–≤–µ—Å—Ç–æ—Ä –∏ —Å–ø–µ–∫—É–ª—è–Ω—Ç? ‚Äî –ò–Ω–≤–µ—Å—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –∫–∞–ø–∏—Ç–∞–ª –Ω–∞ –≥–æ–¥–∞, —Å–ø–µ–∫—É–ª—è–Ω—Ç –ª–æ–≤–∏—Ç –∫—Ä–∞—Ç–∫–∏–π –∑–∞—Ä–∞–±–æ—Ç–æ–∫ —Å –±–æ–ª—å—à–∏–º —Ä–∏—Å–∫–æ–º.",
]

# --- –ö–ù–û–ü–ö–ò –ú–ï–ù–Æ ---

def get_main_menu_keyboard():
    return ReplyKeyboardMarkup([
        ["üìö –ö–Ω–∏–≥–∏", "üìù FAQ", "üß© –°–æ–≤–µ—Ç—ã"],
        ["üí° –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–Ω—å–≥–∞–º–∏", "üî• –ú–æ—Ç–∏–≤–∞—Ü–∏—è", "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"],
    ], resize_keyboard=True)

def get_books_keyboard():
    return ReplyKeyboardMarkup([
        ["–°–∞–º—ã–π –±–æ–≥–∞—Ç—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ –í–∞–≤–∏–ª–æ–Ω–µ"],
        ["–†–∞–∑—É–º–Ω—ã–π –∏–Ω–≤–µ—Å—Ç–æ—Ä"],
        ["–î—É–º–∞–π –∏ –±–æ–≥–∞—Ç–µ–π"],
        ["–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"]
    ], resize_keyboard=True)

class InvestmentSuperBot:
    def __init__(self):
        self.init_db()

    def init_db(self):
        con = sqlite3.connect("users.db")
        cur = con.cursor()
        cur.execute(
            "CREATE TABLE IF NOT EXISTS user_stats (user_id INTEGER PRIMARY KEY, name TEXT, questions_count INTEGER, last_visit TEXT)"
        )
        con.commit()
        con.close()

    def update_user_stat(self, user_id, name):
        con = sqlite3.connect("users.db")
        cur = con.cursor()
        cur.execute(
            "INSERT OR IGNORE INTO user_stats (user_id, name, questions_count, last_visit) VALUES (?, ?, 0, datetime('now'))",
            (user_id, name)
        )
        cur.execute(
            "UPDATE user_stats SET last_visit=datetime('now') WHERE user_id=?",
            (user_id,)
        )
        con.commit()
        con.close()

    def increment_questions(self, user_id):
        con = sqlite3.connect("users.db")
        cur = con.cursor()
        cur.execute(
            "UPDATE user_stats SET questions_count = questions_count + 1 WHERE user_id=?",
            (user_id,)
        )
        con.commit()
        con.close()

    # ==== –ö–û–ú–ê–ù–î–´ ====

    async def start(self, update: Update, context: CallbackContext):
        user = update.effective_user
        self.update_user_stat(user.id, user.first_name)
        text = (
            f"–ü—Ä–∏–≤–µ—Ç, {user.first_name} üëã\n"
            "–Ø –±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º, –¥–µ–Ω–µ–∂–Ω—ã–º –ø—Ä–∏–≤—ã—á–∫–∞–º –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –º–æ—Ç–∏–≤–∞—Ü–∏–∏!\n"
            "–ú–æ–≥—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –ª—É—á—à–∏–º–∏ —Å–æ–≤–µ—Ç–∞–º–∏ –∏ –∑–Ω–∞–Ω–∏—è–º–∏ –∏–∑ –∫–Ω–∏–≥.\n"
            "–í–æ—Å–ø–æ–ª—å–∑—É–π—Å—è –º–µ–Ω—é –∏–ª–∏ –Ω–∞–ø–∏—à–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–π –∫–Ω–∏–≥–∏, —Ç–µ–º—É, –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤–æ–ø—Ä–æ—Å."
        )
        await update.message.reply_text(text, reply_markup=get_main_menu_keyboard())

    async def show_books(self, update: Update, context: CallbackContext):
        await update.message.reply_text(
            "üìö –í—ã–±–µ—Ä–∏ –∫–Ω–∏–≥—É –¥–ª—è —á—Ç–µ–Ω–∏—è (—Ü–∏—Ç–∞—Ç—ã –∏ –≥–ª–∞–≤—ã):",
            reply_markup=get_books_keyboard()
        )

    async def show_faq(self, update: Update, context: CallbackContext):
        faq_text = "\n".join(f"‚Ä¢ {q}" for q in FAQ)
        await update.message.reply_text(f"üìù –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã:\n{faq_text}", reply_markup=get_main_menu_keyboard())

    async def show_tips(self, update: Update, context: CallbackContext):
        tips_text = "\n".join(f"‚ûï {tip}" for tip in INVEST_TIPS)
        await update.message.reply_text(f"üß© –°–æ–≤–µ—Ç—ã –∏–Ω–≤–µ—Å—Ç–æ—Ä—É:\n{tips_text}", reply_markup=get_main_menu_keyboard())

    async def show_money(self, update: Update, context: CallbackContext):
        mm_text = "\n".join(f"üí° {tip}" for tip in MONEY_MANAGEMENT_TIPS)
        await update.message.reply_text(f"üí° –°–æ–≤–µ—Ç—ã –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –¥–µ–Ω—å–≥–∞–º–∏:\n{mm_text}", reply_markup=get_main_menu_keyboard())

    async def show_motivation(self, update: Update, context: CallbackContext):
        mot_text = "\n".join(f"üî• {m}" for m in MOTIVATION)
        await update.message.reply_text(f"üî• –ú–æ—Ç–∏–≤–∞—Ü–∏—è –¥–ª—è —Ç–µ–±—è:\n{mot_text}", reply_markup=get_main_menu_keyboard())

    async def show_book_content(self, update: Update, context: CallbackContext):
        msg = update.message.text.strip()
        for book in BOOKS_MENU:
            if book.lower() in msg.lower():
                await update.message.reply_text(
                    f"üìñ {book}\n{BOOKS_CONTENT[book]}",
                    reply_markup=get_books_keyboard()
                )
                return
        await self.show_books(update, context)

    async def handle_message(self, update: Update, context: CallbackContext):
        user = update.effective_user
        self.update_user_stat(user.id, user.first_name)
        self.increment_questions(user.id)
        msg = update.message.text.strip().lower()

        if "faq" in msg:
            await self.show_faq(update, context)
            return
        if "—Å–æ–≤–µ—Ç" in msg:
            await self.show_tips(update, context)
            return
        if "–∫–Ω–∏–≥" in msg or "–≥–ª–∞–≤" in msg or "–≤–∞–≤–∏–ª–æ–Ω" in msg or "–∏–Ω–≤–µ—Å—Ç–æ—Ä" in msg or "–¥—É–º–∞–π" in msg:
            await self.show_books(update, context)
            return
        if any(book.lower() in msg for book in BOOKS_MENU):
            await self.show_book_content(update, context)
            return
        if "–º–æ—Ç–∏–≤–∞—Ü" in msg:
            await self.show_motivation(update, context)
            return
        if "–¥–µ–Ω—å–≥" in msg or "—É–ø—Ä–∞–≤–ª" in msg or "–±—é–¥–∂–µ—Ç" in msg:
            await self.show_money(update, context)
            return
        if "–º–µ–Ω—é" in msg or "–≥–ª–∞–≤–Ω–æ–µ" in msg:
            await self.start(update, context)
            return
        await update.message.reply_text(
            "–ù–∞–ø–∏—à–∏ –Ω–∞ –∫–∞–∫—É—é —Ç–µ–º—É —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å: '–ö–Ω–∏–≥–∏', '–°–æ–≤–µ—Ç—ã', 'FAQ', '–ú–æ—Ç–∏–≤–∞—Ü–∏—è', '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ–Ω—å–≥–∞–º–∏', '–ú–µ–Ω—é', –∏–ª–∏ –Ω–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É!",
            reply_markup=get_main_menu_keyboard()
        )

    def setup_handlers(self, application):
        application.add_handler(CommandHandler("start", self.start))
        application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, self.handle_message))

def main():
    print("üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞...")
    bot = InvestmentSuperBot()
    application = Application.builder().token(BOT_TOKEN).build()
    bot.setup_handlers(application)
    print("‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç! –ü–∏—à–∏ –µ–º—É –≤ Telegram /start")
    application.run_polling()

if __name__ == "__main__":
    main()

